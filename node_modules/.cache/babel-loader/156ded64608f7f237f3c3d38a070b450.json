{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\srini\\\\OneDrive\\\\Desktop\\\\vedenta\\\\vedanta-multi-sensor\\\\src\\\\pages\\\\reports\\\\Reports.jsx\",\n    _s = $RefreshSig$();\n\nimport React from \"react\";\nimport \"../reports/reports.scss\";\nimport { useState, useEffect } from \"react\";\nimport ReportPopup from \"./ReportPopup\";\nimport * as XLSX from 'xlsx';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst Reports = () => {\n  _s();\n\n  const [isOpenreport, setIsOpenreport] = useState(false);\n  const [selectedWaveGuide, setSelectedWaveGuide] = useState();\n  const [infoReport, setInfoReport] = useState([]);\n  const [errorReport, setErrorReport] = useState(false);\n  useEffect(() => {\n    const fetchData = async () => {\n      try {\n        const response = await fetch(\"http://localhost:4000/sensor/find\");\n        const infoVal = await response.json();\n        setInfoReport(infoVal);\n      } catch (error) {\n        setErrorReport(error);\n      }\n    };\n\n    const interval = setInterval(() => {\n      fetchData();\n    }, 1000);\n    return () => {\n      clearInterval(interval);\n    };\n  }, []);\n\n  if (errorReport) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [\"Error: \", errorReport.message]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 34,\n      columnNumber: 12\n    }, this);\n  }\n\n  if (!infoReport) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      children: \"Loading...\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 37,\n      columnNumber: 12\n    }, this);\n  } // var sensors = {};\n  // var updateTimes = {};\n  // for (let index = 1; index <= 108; index++) {\n  //   var sensorName = \"sensor\" + index;\n  //   sensors[sensorName] = infoReport[index - 1]?.sensor1;\n  //   updateTimes[sensorName] = infoReport[index - 1]?.updatedAt;\n  // }\n\n\n  const sensorData = infoReport.map(item => {\n    const sensorValues = Object.entries(item).filter(_ref => {\n      let [key] = _ref;\n      return key.startsWith('sensor');\n    }).map(_ref2 => {\n      let [key, value] = _ref2;\n      return {\n        name: key,\n        value\n      };\n    });\n    return sensorValues;\n  });\n  var sensorNameXl = [];\n\n  for (let index = 1; index <= 108; index++) {\n    sensorNameXl[index] = `CBT ${index}`;\n  }\n\n  const generateExcel = () => {\n    const workbook = XLSX.utils.book_new();\n    const data = [[...sensorNameXl.map(sensor => [sensor]).slice(1)], ...sensorData.map(sensorDataExcel => sensorDataExcel.map(sensor => sensor.value))];\n    const worksheet = XLSX.utils.aoa_to_sheet(data);\n    XLSX.utils.book_append_sheet(workbook, worksheet, \"sheet1\");\n    XLSX.writeFile(workbook, \"xyma_vedanta.xlsx\");\n  };\n\n  const handleWaveGuideClick = waveGuideNumber => {\n    setSelectedWaveGuide(waveGuideNumber);\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"report\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"container1\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"content\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"xl\",\n          onClick: () => generateExcel(),\n          children: /*#__PURE__*/_jsxDEV(\"h1\", {\n            children: \"Total Excel\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 85,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 84,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 83,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 82,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"container2\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"box-report\",\n        onClick: () => {\n          setIsOpenreport(true);\n          handleWaveGuideClick(1);\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n          children: \"waveGuide 1\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 95,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"text-sm\",\n          children: \"(CBT1-CBT10)\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 96,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 91,\n        columnNumber: 7\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"box-report\",\n        onClick: () => {\n          setIsOpenreport(true);\n          handleWaveGuideClick(2);\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n          children: \"waveGuide 2\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 102,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"text-sm\",\n          children: \"(CBT11-CBT20)\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 103,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 98,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"box-report\",\n        onClick: () => {\n          setIsOpenreport(true);\n          handleWaveGuideClick(3);\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n          children: \"waveGuide 3\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 109,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"text-sm\",\n          children: \"(CBT21-CBT30)\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 110,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 105,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"box-report\",\n        onClick: () => {\n          setIsOpenreport(true);\n          handleWaveGuideClick(4);\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n          children: \"waveGuide 4\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 116,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"text-sm\",\n          children: \"(CBT31-CBT40)\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 117,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 112,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"box-report\",\n        onClick: () => {\n          setIsOpenreport(true);\n          handleWaveGuideClick(5);\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n          children: \"waveGuide 5\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 123,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"text-sm\",\n          children: \"(CBT41-CBT50)\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 124,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 119,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"box-report\",\n        onClick: () => {\n          setIsOpenreport(true);\n          handleWaveGuideClick(6);\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n          children: \"waveGuide 6\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 130,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"text-sm\",\n          children: \"(CBT51-CBT60)\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 131,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 126,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"box-report\",\n        onClick: () => {\n          setIsOpenreport(true);\n          handleWaveGuideClick(7);\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n          children: \"waveGuide 7\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 137,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"text-sm\",\n          children: \"(CBT61-CBT70)\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 138,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 133,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"box-report\",\n        onClick: () => {\n          setIsOpenreport(true);\n          handleWaveGuideClick(8);\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n          children: \"waveGuide 8\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 144,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"text-sm\",\n          children: \"(CBT71-CBT80)\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 145,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 140,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"box-report\",\n        onClick: () => {\n          setIsOpenreport(true);\n          handleWaveGuideClick(9);\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n          children: \"waveGuide 9\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 151,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"text-sm\",\n          children: \"(CBT81-CBT90)\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 152,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 147,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"box-report\",\n        onClick: () => {\n          setIsOpenreport(true);\n          handleWaveGuideClick(10);\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n          children: \"waveGuide 10\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 158,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"text-sm\",\n          children: \"(CBT91-CBT100)\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 159,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 154,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"box-report\",\n        onClick: () => {\n          setIsOpenreport(true);\n          handleWaveGuideClick(11);\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n          children: \"waveGuide 11\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 165,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"text-sm\",\n          children: \"(CBT101-CBT108)\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 166,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 161,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 90,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(ReportPopup, {\n      Openreportdash: isOpenreport,\n      Closereportdash: () => setIsOpenreport(false),\n      waveGuide: selectedWaveGuide\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 182,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 80,\n    columnNumber: 5\n  }, this);\n};\n\n_s(Reports, \"kx3240hP4yowhJ6YYMrXum0EOhI=\");\n\n_c = Reports;\nexport default Reports;\n\nvar _c;\n\n$RefreshReg$(_c, \"Reports\");","map":{"version":3,"sources":["C:/Users/srini/OneDrive/Desktop/vedenta/vedanta-multi-sensor/src/pages/reports/Reports.jsx"],"names":["React","useState","useEffect","ReportPopup","XLSX","Reports","isOpenreport","setIsOpenreport","selectedWaveGuide","setSelectedWaveGuide","infoReport","setInfoReport","errorReport","setErrorReport","fetchData","response","fetch","infoVal","json","error","interval","setInterval","clearInterval","message","sensorData","map","item","sensorValues","Object","entries","filter","key","startsWith","value","name","sensorNameXl","index","generateExcel","workbook","utils","book_new","data","sensor","slice","sensorDataExcel","worksheet","aoa_to_sheet","book_append_sheet","writeFile","handleWaveGuideClick","waveGuideNumber"],"mappings":";;;AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,OAAO,yBAAP;AACA,SAASC,QAAT,EAAmBC,SAAnB,QAAoC,OAApC;AACA,OAAOC,WAAP,MAAwB,eAAxB;AACA,OAAO,KAAKC,IAAZ,MAAsB,MAAtB;;;AAEA,MAAMC,OAAO,GAAG,MAAM;AAAA;;AAEpB,QAAM,CAACC,YAAD,EAAeC,eAAf,IAAkCN,QAAQ,CAAC,KAAD,CAAhD;AACA,QAAM,CAACO,iBAAD,EAAoBC,oBAApB,IAA4CR,QAAQ,EAA1D;AAEA,QAAM,CAACS,UAAD,EAAaC,aAAb,IAA8BV,QAAQ,CAAC,EAAD,CAA5C;AACA,QAAM,CAACW,WAAD,EAAcC,cAAd,IAAgCZ,QAAQ,CAAC,KAAD,CAA9C;AAEAC,EAAAA,SAAS,CAAC,MAAM;AACd,UAAMY,SAAS,GAAG,YAAY;AAC5B,UAAI;AACF,cAAMC,QAAQ,GAAG,MAAMC,KAAK,CAAC,mCAAD,CAA5B;AACA,cAAMC,OAAO,GAAG,MAAMF,QAAQ,CAACG,IAAT,EAAtB;AACAP,QAAAA,aAAa,CAACM,OAAD,CAAb;AACD,OAJD,CAIE,OAAOE,KAAP,EAAc;AACdN,QAAAA,cAAc,CAACM,KAAD,CAAd;AACD;AACF,KARD;;AASA,UAAMC,QAAQ,GAAGC,WAAW,CAAC,MAAM;AACjCP,MAAAA,SAAS;AACV,KAF2B,EAEzB,IAFyB,CAA5B;AAGA,WAAO,MAAM;AACXQ,MAAAA,aAAa,CAACF,QAAD,CAAb;AACD,KAFD;AAGD,GAhBQ,EAgBN,EAhBM,CAAT;;AAkBA,MAAIR,WAAJ,EAAiB;AACf,wBAAO;AAAA,4BAAaA,WAAW,CAACW,OAAzB;AAAA;AAAA;AAAA;AAAA;AAAA,YAAP;AACD;;AACD,MAAI,CAACb,UAAL,EAAiB;AACf,wBAAO;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,YAAP;AACD,GA/BmB,CAiCtB;AACA;AAEA;AACA;AACA;AACA;AACA;;;AAEE,QAAMc,UAAU,GAAGd,UAAU,CAACe,GAAX,CAAgBC,IAAD,IAAU;AAC1C,UAAMC,YAAY,GAAGC,MAAM,CAACC,OAAP,CAAeH,IAAf,EAClBI,MADkB,CACX;AAAA,UAAC,CAACC,GAAD,CAAD;AAAA,aAAWA,GAAG,CAACC,UAAJ,CAAe,QAAf,CAAX;AAAA,KADW,EAElBP,GAFkB,CAEd;AAAA,UAAC,CAACM,GAAD,EAAME,KAAN,CAAD;AAAA,aAAmB;AAAEC,QAAAA,IAAI,EAAEH,GAAR;AAAaE,QAAAA;AAAb,OAAnB;AAAA,KAFc,CAArB;AAGA,WAAON,YAAP;AACD,GALkB,CAAnB;AAOA,MAAIQ,YAAY,GAAG,EAAnB;;AACA,OAAK,IAAIC,KAAK,GAAG,CAAjB,EAAoBA,KAAK,IAAI,GAA7B,EAAkCA,KAAK,EAAvC,EAA2C;AACtCD,IAAAA,YAAY,CAACC,KAAD,CAAZ,GAAuB,OAAMA,KAAM,EAAnC;AACJ;;AAED,QAAMC,aAAa,GAAG,MAAM;AAC5B,UAAMC,QAAQ,GAAGlC,IAAI,CAACmC,KAAL,CAAWC,QAAX,EAAjB;AACA,UAAMC,IAAI,GAAG,CACX,CAAC,GAAGN,YAAY,CAACV,GAAb,CAAkBiB,MAAD,IAAY,CAACA,MAAD,CAA7B,EAAuCC,KAAvC,CAA6C,CAA7C,CAAJ,CADW,EAEX,GAAGnB,UAAU,CAACC,GAAX,CAAgBmB,eAAD,IAChBA,eAAe,CAACnB,GAAhB,CAAqBiB,MAAD,IAAYA,MAAM,CAACT,KAAvC,CADC,CAFQ,CAAb;AAMA,UAAMY,SAAS,GAAGzC,IAAI,CAACmC,KAAL,CAAWO,YAAX,CAAwBL,IAAxB,CAAlB;AACArC,IAAAA,IAAI,CAACmC,KAAL,CAAWQ,iBAAX,CAA6BT,QAA7B,EAAuCO,SAAvC,EAAkD,QAAlD;AACAzC,IAAAA,IAAI,CAAC4C,SAAL,CAAeV,QAAf,EAAyB,mBAAzB;AACD,GAXC;;AAcA,QAAMW,oBAAoB,GAAIC,eAAD,IAAqB;AAChDzC,IAAAA,oBAAoB,CAACyC,eAAD,CAApB;AACD,GAFD;;AAIA,sBACE;AAAK,IAAA,SAAS,EAAC,QAAf;AAAA,4BAEE;AAAK,MAAA,SAAS,EAAC,YAAf;AAAA,6BACE;AAAK,QAAA,SAAS,EAAC,SAAf;AAAA,+BACE;AAAK,UAAA,SAAS,EAAC,IAAf;AAAoB,UAAA,OAAO,EAAE,MAAIb,aAAa,EAA9C;AAAA,iCACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,YAFF,eAUE;AAAK,MAAA,SAAS,EAAC,YAAf;AAAA,8BACA;AACA,QAAA,SAAS,EAAC,YADV;AAEA,QAAA,OAAO,EAAE,MAAI;AAAC9B,UAAAA,eAAe,CAAC,IAAD,CAAf;AACd0C,UAAAA,oBAAoB,CAAC,CAAD,CAApB;AAAwB,SAHxB;AAAA,gCAII;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBAJJ,eAKI;AAAM,UAAA,SAAS,EAAC,SAAhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBALJ;AAAA;AAAA;AAAA;AAAA;AAAA,cADA,eAQE;AACA,QAAA,SAAS,EAAC,YADV;AAEA,QAAA,OAAO,EAAE,MAAI;AAAC1C,UAAAA,eAAe,CAAC,IAAD,CAAf;AACd0C,UAAAA,oBAAoB,CAAC,CAAD,CAApB;AAAwB,SAHxB;AAAA,gCAIE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBAJF,eAKE;AAAM,UAAA,SAAS,EAAC,SAAhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBALF;AAAA;AAAA;AAAA;AAAA;AAAA,cARF,eAeE;AACA,QAAA,SAAS,EAAC,YADV;AAEA,QAAA,OAAO,EAAE,MAAI;AAAC1C,UAAAA,eAAe,CAAC,IAAD,CAAf;AACd0C,UAAAA,oBAAoB,CAAC,CAAD,CAApB;AAAwB,SAHxB;AAAA,gCAIE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBAJF,eAKE;AAAM,UAAA,SAAS,EAAC,SAAhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBALF;AAAA;AAAA;AAAA;AAAA;AAAA,cAfF,eAsBE;AACA,QAAA,SAAS,EAAC,YADV;AAEA,QAAA,OAAO,EAAE,MAAI;AAAC1C,UAAAA,eAAe,CAAC,IAAD,CAAf;AACd0C,UAAAA,oBAAoB,CAAC,CAAD,CAApB;AAAwB,SAHxB;AAAA,gCAIE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBAJF,eAKE;AAAM,UAAA,SAAS,EAAC,SAAhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBALF;AAAA;AAAA;AAAA;AAAA;AAAA,cAtBF,eA6BE;AACA,QAAA,SAAS,EAAC,YADV;AAEA,QAAA,OAAO,EAAE,MAAI;AAAC1C,UAAAA,eAAe,CAAC,IAAD,CAAf;AACd0C,UAAAA,oBAAoB,CAAC,CAAD,CAApB;AAAwB,SAHxB;AAAA,gCAIE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBAJF,eAKE;AAAM,UAAA,SAAS,EAAC,SAAhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBALF;AAAA;AAAA;AAAA;AAAA;AAAA,cA7BF,eAoCE;AACA,QAAA,SAAS,EAAC,YADV;AAEA,QAAA,OAAO,EAAE,MAAI;AAAC1C,UAAAA,eAAe,CAAC,IAAD,CAAf;AACd0C,UAAAA,oBAAoB,CAAC,CAAD,CAApB;AAAwB,SAHxB;AAAA,gCAIE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBAJF,eAKE;AAAM,UAAA,SAAS,EAAC,SAAhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBALF;AAAA;AAAA;AAAA;AAAA;AAAA,cApCF,eA2CE;AACA,QAAA,SAAS,EAAC,YADV;AAEA,QAAA,OAAO,EAAE,MAAI;AAAC1C,UAAAA,eAAe,CAAC,IAAD,CAAf;AACd0C,UAAAA,oBAAoB,CAAC,CAAD,CAApB;AAAwB,SAHxB;AAAA,gCAIE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBAJF,eAKE;AAAM,UAAA,SAAS,EAAC,SAAhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBALF;AAAA;AAAA;AAAA;AAAA;AAAA,cA3CF,eAkDE;AACA,QAAA,SAAS,EAAC,YADV;AAEA,QAAA,OAAO,EAAE,MAAI;AAAC1C,UAAAA,eAAe,CAAC,IAAD,CAAf;AACd0C,UAAAA,oBAAoB,CAAC,CAAD,CAApB;AAAwB,SAHxB;AAAA,gCAIE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBAJF,eAKE;AAAM,UAAA,SAAS,EAAC,SAAhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBALF;AAAA;AAAA;AAAA;AAAA;AAAA,cAlDF,eAyDE;AACA,QAAA,SAAS,EAAC,YADV;AAEA,QAAA,OAAO,EAAE,MAAI;AAAC1C,UAAAA,eAAe,CAAC,IAAD,CAAf;AACd0C,UAAAA,oBAAoB,CAAC,CAAD,CAApB;AAAwB,SAHxB;AAAA,gCAIE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBAJF,eAKE;AAAM,UAAA,SAAS,EAAC,SAAhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBALF;AAAA;AAAA;AAAA;AAAA;AAAA,cAzDF,eAgEE;AACA,QAAA,SAAS,EAAC,YADV;AAEA,QAAA,OAAO,EAAE,MAAI;AAAC1C,UAAAA,eAAe,CAAC,IAAD,CAAf;AACd0C,UAAAA,oBAAoB,CAAC,EAAD,CAApB;AAAyB,SAHzB;AAAA,gCAIE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBAJF,eAKE;AAAM,UAAA,SAAS,EAAC,SAAhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBALF;AAAA;AAAA;AAAA;AAAA;AAAA,cAhEF,eAuEE;AACA,QAAA,SAAS,EAAC,YADV;AAEA,QAAA,OAAO,EAAE,MAAI;AAAC1C,UAAAA,eAAe,CAAC,IAAD,CAAf;AACd0C,UAAAA,oBAAoB,CAAC,EAAD,CAApB;AAAyB,SAHzB;AAAA,gCAIE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBAJF,eAKE;AAAM,UAAA,SAAS,EAAC,SAAhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBALF;AAAA;AAAA;AAAA;AAAA;AAAA,cAvEF;AAAA;AAAA;AAAA;AAAA;AAAA,YAVF,eAsGE,QAAC,WAAD;AACA,MAAA,cAAc,EAAE3C,YADhB;AAEA,MAAA,eAAe,EAAE,MAAIC,eAAe,CAAC,KAAD,CAFpC;AAGA,MAAA,SAAS,EAAEC;AAHX;AAAA;AAAA;AAAA;AAAA,YAtGF;AAAA;AAAA;AAAA;AAAA;AAAA,UADF;AA+GD,CAvLD;;GAAMH,O;;KAAAA,O;AAyLN,eAAeA,OAAf","sourcesContent":["import React from \"react\";\r\nimport \"../reports/reports.scss\";\r\nimport { useState, useEffect } from \"react\";\r\nimport ReportPopup from \"./ReportPopup\";\r\nimport * as XLSX from 'xlsx';\r\n\r\nconst Reports = () => {\r\n\r\n  const [isOpenreport, setIsOpenreport] = useState(false);\r\n  const [selectedWaveGuide, setSelectedWaveGuide] = useState();\r\n\r\n  const [infoReport, setInfoReport] = useState([]);\r\n  const [errorReport, setErrorReport] = useState(false);\r\n\r\n  useEffect(() => {\r\n    const fetchData = async () => {\r\n      try {\r\n        const response = await fetch(\"http://localhost:4000/sensor/find\");\r\n        const infoVal = await response.json();\r\n        setInfoReport(infoVal);\r\n      } catch (error) {\r\n        setErrorReport(error);\r\n      }\r\n    };\r\n    const interval = setInterval(() => {\r\n      fetchData();\r\n    }, 1000);\r\n    return () => {\r\n      clearInterval(interval);\r\n    };\r\n  }, []);\r\n\r\n  if (errorReport) {\r\n    return <div>Error: {errorReport.message}</div>;\r\n  }\r\n  if (!infoReport) {\r\n    return <div>Loading...</div>;\r\n  }\r\n\r\n// var sensors = {};\r\n// var updateTimes = {};\r\n\r\n// for (let index = 1; index <= 108; index++) {\r\n//   var sensorName = \"sensor\" + index;\r\n//   sensors[sensorName] = infoReport[index - 1]?.sensor1;\r\n//   updateTimes[sensorName] = infoReport[index - 1]?.updatedAt;\r\n// }\r\n\r\n  const sensorData = infoReport.map((item) => {\r\n    const sensorValues = Object.entries(item)\r\n      .filter(([key]) => key.startsWith('sensor'))\r\n      .map(([key, value]) => ({ name: key, value }));\r\n    return sensorValues;\r\n  });\r\n\r\n  var sensorNameXl = [];\r\n  for (let index = 1; index <= 108; index++) {\r\n       sensorNameXl[index] = `CBT ${index}`;\r\n  }\r\n\r\n  const generateExcel = () => {\r\n  const workbook = XLSX.utils.book_new();\r\n  const data = [\r\n    [...sensorNameXl.map((sensor) => [sensor]).slice(1)],\r\n    ...sensorData.map((sensorDataExcel) =>\r\n      sensorDataExcel.map((sensor) => sensor.value)\r\n    ),\r\n  ];\r\n  const worksheet = XLSX.utils.aoa_to_sheet(data);\r\n  XLSX.utils.book_append_sheet(workbook, worksheet, \"sheet1\");\r\n  XLSX.writeFile(workbook, \"xyma_vedanta.xlsx\");\r\n};\r\n\r\n\r\n  const handleWaveGuideClick = (waveGuideNumber) => {\r\n    setSelectedWaveGuide(waveGuideNumber);\r\n  };\r\n\r\n  return (\r\n    <div className=\"report\">\r\n\r\n      <div className=\"container1\">\r\n        <div className=\"content\">\r\n          <div className=\"xl\" onClick={()=>generateExcel()}>\r\n            <h1>Total Excel</h1>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <div className=\"container2\">\r\n      <div \r\n      className=\"box-report\" \r\n      onClick={()=>{setIsOpenreport(true);\r\n      handleWaveGuideClick(1)}}>\r\n          <h1>waveGuide 1</h1>\r\n          <span className=\"text-sm\">(CBT1-CBT10)</span>\r\n        </div>\r\n        <div \r\n        className=\"box-report\" \r\n        onClick={()=>{setIsOpenreport(true);\r\n        handleWaveGuideClick(2)}}>\r\n          <h1>waveGuide 2</h1>\r\n          <span className=\"text-sm\">(CBT11-CBT20)</span>\r\n        </div>\r\n        <div \r\n        className=\"box-report\" \r\n        onClick={()=>{setIsOpenreport(true);\r\n        handleWaveGuideClick(3)}}>\r\n          <h1>waveGuide 3</h1>\r\n          <span className=\"text-sm\">(CBT21-CBT30)</span>\r\n        </div>\r\n        <div \r\n        className=\"box-report\" \r\n        onClick={()=>{setIsOpenreport(true);\r\n        handleWaveGuideClick(4)}}>\r\n          <h1>waveGuide 4</h1>\r\n          <span className=\"text-sm\">(CBT31-CBT40)</span>\r\n        </div>\r\n        <div \r\n        className=\"box-report\" \r\n        onClick={()=>{setIsOpenreport(true);\r\n        handleWaveGuideClick(5)}}>\r\n          <h1>waveGuide 5</h1>\r\n          <span className=\"text-sm\">(CBT41-CBT50)</span>\r\n        </div>\r\n        <div \r\n        className=\"box-report\" \r\n        onClick={()=>{setIsOpenreport(true);\r\n        handleWaveGuideClick(6)}}>\r\n          <h1>waveGuide 6</h1>\r\n          <span className=\"text-sm\">(CBT51-CBT60)</span>\r\n        </div>\r\n        <div \r\n        className=\"box-report\" \r\n        onClick={()=>{setIsOpenreport(true);\r\n        handleWaveGuideClick(7)}}>\r\n          <h1>waveGuide 7</h1>\r\n          <span className=\"text-sm\">(CBT61-CBT70)</span>\r\n        </div>\r\n        <div \r\n        className=\"box-report\" \r\n        onClick={()=>{setIsOpenreport(true);\r\n        handleWaveGuideClick(8)}}>\r\n          <h1>waveGuide 8</h1>\r\n          <span className=\"text-sm\">(CBT71-CBT80)</span>\r\n        </div>\r\n        <div \r\n        className=\"box-report\" \r\n        onClick={()=>{setIsOpenreport(true);\r\n        handleWaveGuideClick(9)}}>\r\n          <h1>waveGuide 9</h1>\r\n          <span className=\"text-sm\">(CBT81-CBT90)</span>\r\n        </div>\r\n        <div \r\n        className=\"box-report\" \r\n        onClick={()=>{setIsOpenreport(true);\r\n        handleWaveGuideClick(10)}}>\r\n          <h1>waveGuide 10</h1>\r\n          <span className=\"text-sm\">(CBT91-CBT100)</span>\r\n        </div>\r\n        <div \r\n        className=\"box-report\" \r\n        onClick={()=>{setIsOpenreport(true);\r\n        handleWaveGuideClick(11)}}>\r\n          <h1>waveGuide 11</h1>\r\n          <span className=\"text-sm\">(CBT101-CBT108)</span>\r\n        </div>\r\n        {/* <div className=\"box-report hide\">\r\n          <h1>waveGuide 12</h1>\r\n        </div>\r\n        <div className=\"box-report hide\">\r\n          <h1>waveGuide 13</h1>\r\n        </div>\r\n        <div className=\"box-report hide\">\r\n          <h1>waveGuide 14</h1>\r\n        </div>\r\n        <div className=\"box-report hide\">\r\n          <h1>waveGuide 15</h1>\r\n        </div> */}\r\n      </div>\r\n\r\n      <ReportPopup\r\n      Openreportdash={isOpenreport} \r\n      Closereportdash={()=>setIsOpenreport(false)}\r\n      waveGuide={selectedWaveGuide}\r\n      />\r\n\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Reports;\r\n"]},"metadata":{},"sourceType":"module"}